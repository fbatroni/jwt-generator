/*eslint no-process-env: "off"*/

"use strict";

/********************************************************************
 * Config
 ********************************************************************/

const config = require('../config/config.js');

/********************************************************************
 * Main Exports
 ********************************************************************/

module.exports = {
  getValidatedRedirect: req => new Promise(resolve => {
    if (req.headers['x-starphleet-authentic'] === config.authenticToken &&
      req.headers['x-starphleet-redirect'] === "true" &&
      req.headers['x-starphleet-originalurl'] &&
      req.headers['x-starphleet-originalurl'] !== "") {
      return resolve(req.headers['x-starphleet-originalurl']);
    }
    throw new Error("Invalid Redirect");
  })
};
